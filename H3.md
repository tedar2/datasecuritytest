# H3 

## Read and summarize: Costa-Gazcón 2021: Practical Threat Intelligence and Data-Driven Threat Hunting (chapter4: Mapping the adversary)

The article covers the following topics: 

+ The ATT&CK Framework
+ Mapping with ATT&CK
+ Testing yourself

The ATT&CK framework (Adversarial Tactics, Techniques, and Common Knowledge) is a publicly-accessible database of tactics and techniques used by cyber adversaries. It is maintained by MITRE Corporation and is used as a reference for threat analysis, incident response, and proactive defense. The framework provides a common language and understanding of cyber-attacks, enabling organizations to better detect and defend against these attacks by mapping them to specific tactics and techniques.

The ATT&CK framework outlines 14 tactics used by threat actors in an attack. The tactics cover different stages of an attack, including reconnaissance, initial access, execution, persistence, privilege escalation, defense evasion, credential access, discovery, lateral movement, collection, command and control, exfiltration, and impact. Each tactic is comprised of specific techniques and sub-techniques that describe the behavior of the threat actor. The framework has recently been updated to improve the granularity of the sub-technique system and to avoid overlap between techniques. The procedures describe the specific way in which a threat actor implements a technique or sub-technique, and one procedure can expand into multiple techniques and sub-techniques.

The ATT&CK Matrix - 
![image](https://user-images.githubusercontent.com/90892301/216816889-79b185ec-ffb9-48f1-8025-07f981db076c.png)

The techniques contain the following information: a name, a list of subtechniques and their descriptions, the data source and a scorecard. 

A techinique example: 
<img width="983" alt="image" src="https://user-images.githubusercontent.com/90892301/216817428-45b2bc8c-7f55-44a4-b82d-627890796e11.png">

ATT&CK Navigator is a tool provided by MITRE to visualize the relationships between techniques, tactics, and software in the ATT&CK framework. It allows users to explore the matrix and understand the relationships between different techniques and tactics, and how these might apply to specific software. The Navigator provides a graphical representation of the ATT&CK matrix, making it easier to understand the relationships between different elements and how they can be used to defend against or detect cyber threats.

![image](https://user-images.githubusercontent.com/90892301/216817732-d71de664-d723-40ee-88f9-b527966f3c55.png)

Mapping with ATT&CK

The exercise describes the process of mapping the behavior of the Formbook infostealer to the techniques and sub-techniques within the ATT&CK framework. The infostealer is described as a tool that can steal authorization and login credentials, keylog information even when victims use a virtual keyboard or auto-fill, and take screenshots. The exercise outlines the process of identifying the relevant tactics and techniques within the ATT&CK matrix, specifically T1555 – Credentials from Password Stores, T1555.003 – Credentials from Web Browsers, T1056 – Input Capture, T1056.001 – Keylogging, and T1113 – Screen Capture.

Testing yourself (bonus)

The malware sample "Formbook" is a botnet that infects victims and retrieves information from them to be managed in a web panel. Formbook was distributed via PDFs, DOC files, XLS files, and RTF files. The sample being analyzed is a RAR SFX archive that contains several files, including an AutoIt script (axo.exe) that decrypts and loads Formbook into memory. The script changes the folder attributes to hide its contents and modifies the registry key to remain persistent on the system. Formbook has various features, including an install manager, file browsing, full Unicode support, and the ability to receive commands from the C&C server to download and execute, update, visit URLs, take screenshots, and more.

The techniques found in the article include:
Defense Evasion & Privilege Escalation: Process Injection (Dynamic-link Library Injection, Portable Executable Injection)
Collection & Credential Access: Input Capture (Credential API Hooking)
Command and Control: Encrypted Channel
Discovery: File and Directory Discovery
Execution: Command and Scripting Interpreter
Impact: System Shutdown/Reboot
Collection: Screen Capture
Initial Access: Phishing (Spearphishing Attachment, Spearphishing Link)
Execution: User Execution (Malicious Link, Malicious File)
Defense Evasion: Obfuscated Files or Information (Software Packing), Indicator Removal on Host (File Deletion), Hide Artifacts (Hidden Files and Directories)
Persistence & Privilege Escalation: Boot or Logon Autostart Execution (Registry Run Keys/Startup Folder)
Defense Evasion: Virtualization/Sandbox Evasion (Time Based Evasion, System Checks), Modify Registry, Impair Defenses (Disable or Modify Tools)
Defense Evasion & Privilege Escalation: Abuse Elevation Control Mechanism (Bypass User Access Control)
Discovery: Peripheral Device Discovery, Process Discovery, Software Discovery.
Some of the techniques are marked with an asterisk (*) indicating that they may be debatable in their classification.

Sources: [MITRE ATT&CK®](https://attack.mitre.org/), [O'Reilly: Chapter 4: Mapping the Adversary](https://learning.oreilly.com/library/view/practical-threat-intelligence/9781838556372/B13376_04_Final_SK_ePub.xhtml#_idParaDest-71), [Virus Bulletin 2018: Inside Formbook Infostealer](https://www.virusbulletin.com/uploads/pdf/magazine/2018/VB2018-Nicolao.pdf), 
### h3 He
