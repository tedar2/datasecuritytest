# A02:2021 - Cryptographic Failures


Cryptographic failure is the root cause for sensitive data exposure. According to the Open Web Application Security Project (OWASP) 2021, securing your data against cryptographic failures has become more important than ever.

A cryptographic failure flaw can occur when you do the following:

Store or transit data in clear text (most common)
Protect data with an old or weak encryption
Improperly filter or mask data in transit

Source: https://support.f5.com/csp/article/K00174750

## Example Attack Scenarios

### Scenario #1: 
An application encrypts credit card numbers in a database using automatic database encryption. However, this data is automatically decrypted when retrieved, allowing a SQL injection flaw to retrieve credit card numbers in clear text.

### Scenario #2: 
A site doesn't use or enforce TLS for all pages or supports weak encryption. An attacker monitors network traffic (e.g., at an insecure wireless network), downgrades connections from HTTPS to HTTP, intercepts requests, and steals the user's session cookie. The attacker then replays this cookie and hijacks the user's (authenticated) session, accessing or modifying the user's private data. Instead of the above they could alter all transported data, e.g., the recipient of a money transfer.

### Scenario #3: 
The password database uses unsalted or simple hashes to store everyone's passwords. A file upload flaw allows an attacker to retrieve the password database. All the unsalted hashes can be exposed with a rainbow table of pre-calculated hashes. Hashes generated by simple or fast hash functions may be cracked by GPUs, even if they were salted.

Source: https://owasp.org/Top10/A02_2021-Cryptographic_Failures/ 

